# nau_structure.py
"""
NAU Structure - Полная структура НАУ со всеми вариантами написания
Обновлено: 2025
"""

NAU_STRUCTURE = {
    "ФКНТ": {
        "full_name": "Факультет комп'ютерних наук та технологій",
        "level": "faculty",
        "aliases": [
            "фкнт", "фкит", "фкнит",
            
            "факультет комп'ютерних наук",
            "факультет компютерних наук",
            "факультет комп'ютерних наук та технологій",
            "факультет комп'ютерних наук і технологій",
            "комп'ютерних наук",
            "компютерних наук",
            
            "факультет компьютерных наук",
            "факультет информатики",
            "факультет компьютерных наук и технологий",
            "компьютерных наук",
            "информатики",
            
            "computer science faculty",
            "faculty of computer science",
            "computer science and technology",
            "cs faculty",
            
            "комп'ютерний факультет",
            "айтішний факультет",
            "ит факультет",
            "факультет айті",
            "факультет программистов",
            "факультет программування",
            
            "фкнт", "фкит", "фкнит", "фкнтт",
            "компютерних", "компьютерных",
            
            "fknt", "fkit",
        ],
        
        "departments": {
            "ПМ": {
                "full_name": "Кафедра прикладної математики",
                "level": "department",
                "aliases": [
                    "пм", "прикладна математика", "прикладной математики",
                    
                    "кафедра прикладної математики",
                    "кафедра прикладной математики",
                    "прикладна математика",
                    "прикладная математика",
                    "applied mathematics",
                    
                    "математики", "матан", "прикладная матеша",
                    "прикладна матеша", "мат кафедра",
                    
                    "прикладная", "прикладна", "математика",
                ],
                "common_queries": [
                    "вищa математика", "математичний аналіз",
                    "диференційні рівняння", "теорія ймовірностей",
                ]
            },
            
            "ІПЗ": {
                "full_name": "Кафедра інженерії програмного забезпечення",
                "level": "department",
                "head": "Малярчук Павло Іванович",
                "aliases": [
                    "іпз", "ипз", "ипз кафедра",
                    
                    "кафедра інженерії програмного забезпечення",
                    "інженерії програмного забезпечення",
                    "інженерія програмного забезпечення",
                    "інженерія пз",
                    "кафедра ипз",
                    
                    "кафедра инженерии программного обеспечения",
                    "инженерии программного обеспечения",
                    "инженерия программного обеспечения",
                    "инженерия по",
                    
                    "software engineering",
                    "software engineering department",
                    "se department",
                    "software eng",
                    
                    "програмного забезпечення",
                    "программного обеспечения",
                    "софтверної інженерії",
                    "софтверная инженерия",
                    "программирование",
                    "програмування",
                    "розробка по",
                    "разработка по",
                    
                    "121", "121 спеціальність",
                    "інженерія програмного забезпечення 121",
                    
                    "ипз", "іпз", "программного", "програмного",
                    "забезпечення", "обеспечения",
                    
                    "ipz", "se dept",
                ],
                "common_queries": [
                    "java", "python", "c++", "web розробка",
                    "мобільні додатки", "бази даних",
                    "ооп", "патерни проектування",
                    "малярчук", "pavlo maliarchuk",
                ]
            },
            
            "КІТ": {
                "full_name": "Кафедра комп'ютерних інформаційних технологій",
                "level": "department",
                "aliases": [
                    "кіт", "кит", "кіт кафедра",
                    
                    "кафедра комп'ютерних інформаційних технологій",
                    "комп'ютерних інформаційних технологій",
                    "компютерних інформаційних технологій",
                    "комп'ютерні інформаційні технології",
                    
                    "кафедра компьютерных информационных технологий",
                    "компьютерных информационных технологий",
                    "компьютерные информационные технологии",
                    "компьютерные технологии",
                    
                    "computer information technologies",
                    "cit department",
                    "information technology",
                    "it department",
                    
                    "інформаційних технологій",
                    "информационных технологий",
                    "айті кафедра",
                    "ит технологии",
                    
                    "126", "126 спеціальність",
                    "інформаційні системи та технології",
                    
                    "кит", "кіт", "компютерних", "информационных",
                    
                    "kit", "cit",
                ],
                "common_queries": [
                    "інформаційні системи", "бази даних",
                    "data science", "big data",
                    "аналіз даних", "машинне навчання",
                ]
            },
            
            "КСМ": {
                "full_name": "Кафедра комп'ютерних систем та мереж",
                "level": "department",
                "aliases": [
                    "ксм", "ксм кафедра",
                    
                    "кафедра комп'ютерних систем та мереж",
                    "комп'ютерних систем та мереж",
                    "компютерних систем та мереж",
                    "комп'ютерні системи та мережі",
                    "комп'ютерні системи і мережі",
                    
                    "кафедра компьютерных систем и сетей",
                    "компьютерных систем и сетей",
                    "компьютерные системы и сети",
                    
                    "computer systems and networks",
                    "csn department",
                    "computer networks",
                    "networks department",
                    
                    "системи та мережі",
                    "системы и сети",
                    "комп'ютерні мережі",
                    "компьютерные сети",
                    "мережева кафедра",
                    "сетевая кафедра",
                    "кафедра мереж",
                    
                    "123", "123 спеціальність",
                    "комп'ютерна інженерія",
                    
                    "ксм", "компютерних", "систем", "мереж",
                    
                    "ksm", "csn",
                ],
                "common_queries": [
                    "мережі", "networks", "cisco",
                    "адміністрування", "серверы",
                    "linux", "windows server",
                ]
            },
            
            "КЗЗІ": {
                "full_name": "Кафедра технічного захисту інформації",
                "level": "department",
                "aliases": [
                    "кззі", "кзі", "ззі", "кззи", "тзі",
                    
                    "кафедра технічного захисту інформації",
                    "технічного захисту інформації",
                    "технічний захист інформації",
                    "кафедра захисту інформації",
                    "захист інформації",
                    
                    "кафедра технической защиты информации",
                    "технической защиты информации",
                    "техническая защита информации",
                    "защита информации",
                    
                    "technical information protection",
                    "technical information security",
                    "infosec department",
                    "information protection department",
                    
                    "технічного захисту",
                    "технической защиты",
                    "техзахист",
                    "техзащита",
                    "захисту інформації",
                    "защиты информации",
                    "інформбезпека",
                    "информбезопасность",
                    "безпека інформації",
                    "безопасность информации",
                    
                    "125", "125 спеціальність",
                    "кібербезпека та захист інформації",
                    "технічний захист",
                    
                    "ззі", "кззі", "тзі", "захисту", "защиты", "технічного",
                    
                    "kzzi", "zzi", "tzi", "technical protection",
                ],
                "common_queries": [
                    "криптографія", "шифрування", "encryption",
                    "безпека", "security", "захист даних",
                    "технічні засоби", "спеціальні дослідження",
                    "витік інформації", "каналі витоку",
                    "акустичн захист", "радіочастотн контроль",
                ]
            },
            
            "КСЗІ": {
                "full_name": "Кафедра кібербезпеки",
                "level": "department",
                "aliases": [
                    "ксзі", "кибербезопасности", "кібербезпеки",
                    
                    "кафедра кібербезпеки",
                    "кафедра кібербезпеки та захисту інформації",
                    "кібербезпека",
                    "кібербезпека та захист інформації",
                    
                    "кафедра кибербезопасности",
                    "кибербезопасность",
                    "кибербезопасность и защита информации",
                    
                    "cybersecurity",
                    "cybersecurity department",
                    "cyber security",
                    "infosec",
                    
                    "кібер", "киберзащита",
                    "кіберзахист", "cyber",
                    "безопасность", "безпека",
                    
                    "125", "кібербезпека 125",
                    
                    "ксзі", "кибербезопасности", "кібербезпеки",
                    
                    "kszi", "cyber",
                ],
                "common_queries": [
                    "хакінг", "пентест", "ethical hacking",
                    "взлом", "вразливості",
                    "захист мереж", "firewall",
                ]
            },
            
            "ІКС": {
                "full_name": "Кафедра інтелектуальних кібернетичних систем",
                "level": "department",
                "aliases": [
                    "ікс", "икс", "ікс кафедра",
                    
                    "кафедра інтелектуальних кібернетичних систем",
                    "інтелектуальних кібернетичних систем",
                    "інтелектуальні кібернетичні системи",
                    
                    "кафедра интеллектуальных кибернетических систем",
                    "интеллектуальных кибернетических систем",
                    "интеллектуальные кибернетические системы",
                    
                    "intelligent cybernetic systems",
                    "ics department",
                    "intelligent systems",
                    
                    "кібернетичних систем",
                    "кибернетических систем",
                    "кібернетика",
                    "кибернетика",
                    "інтелектуальні системи",
                    "интеллектуальные системы",
                    "ai кафедра",
                    "штучний інтелект",
                    "искусственный интеллект",
                    
                    "126", "системи штучного інтелекту",
                    
                    "ікс", "икс", "інтелектуальних", "кібернетичних",
                    
                    "iks", "ics",
                ],
                "common_queries": [
                    "ai", "machine learning", "deep learning",
                    "нейронні мережі", "робототехніка",
                    "комп'ютерний зір", "nlp",
                ]
            },
        }
    },
    
    "ФАЕТ": {
        "full_name": "Факультет аеронавігації, електроніки та телекомунікацій",
        "level": "faculty",
        "aliases": [
            "фает", "фаєт",
            
            "факультет аеронавігації",
            "факультет аеронавігації електроніки та телекомунікацій",
            "факультет аеронавігації, електроніки та телекомунікацій",
            "аеронавігації електроніки телекомунікацій",
            "аеронавігації",
            "електроніки",
            "телекомунікацій",
            
            "факультет аэронавигации",
            "факультет аэронавигации электроники и телекоммуникаций",
            "аэронавигации",
            "электроники",
            "телекоммуникаций",
            
            "faculty of air navigation",
            "air navigation faculty",
            "electronics and telecommunications",
            "aeronavigation",
            
            "авіаційний факультет",
            "авиационный факультет",
            "факультет електроніки",
            "факультет связи",
            "факультет зв'язку",
            "радіофакультет",
            "радиофакультет",
            
            "фает", "фаєт", "аеронавігації", "електроніки",
            
            "faet", "fayet",
        ],
        
        "departments": {
            "ТКС": {
                "full_name": "Кафедра телекомунікаційних та радіоелектронних систем",
                "level": "department",
                "aliases": [
                    "ткс", "ткс кафедра",
                    
                    "кафедра телекомунікаційних та радіоелектронних систем",
                    "телекомунікаційних та радіоелектронних систем",
                    "телекомунікаційні та радіоелектронні системи",
                    "телекомунікацій та радіоелектроніки",
                    
                    "кафедра телекоммуникационных и радиоэлектронных систем",
                    "телекоммуникационных и радиоэлектронных систем",
                    "телекоммуникационные и радиоэлектронные системы",
                    
                    "telecommunications and radio electronic systems",
                    "telecom department",
                    "radio electronic systems",
                    
                    "телекомунікацій",
                    "телекоммуникаций",
                    "радіоелектроніки",
                    "радиоэлектроники",
                    "зв'язку",
                    "связи",
                    "радіо кафедра",
                    "радио кафедра",
                    
                    "172", "телекомунікації та радіотехніка",
                    
                    "ткс", "телекомунікаційних", "радіоелектронних",
                    
                    "tks", "telecom",
                ],
                "common_queries": [
                    "радіо", "зв'язок", "антени",
                    "телекомунікації", "сигнали",
                    "радіохвилі", "передавачі",
                ]
            },
            
            "АСУ": {
                "full_name": "Кафедра авіоніки та систем управління",
                "level": "department",
                "aliases": [
                    "асу", "асу кафедра",
                    
                    "кафедра авіоніки та систем управління",
                    "авіоніки та систем управління",
                    "авіоніка та системи управління",
                    "авіоніка",
                    
                    "кафедра авионики и систем управления",
                    "авионики и систем управления",
                    "авионика и системы управления",
                    "авионика",
                    
                    "avionics and control systems",
                    "avionics department",
                    "aircraft systems",
                    "control systems",
                    
                    "систем управління",
                    "систем управления",
                    "авіаційні системи",
                    "авиационные системы",
                    "літакові системи",
                    "самолетные системы",
                    "автоматика",
                    
                    "151", "автоматизація та комп'ютерно-інтегровані технології",
                    
                    "асу", "авіоніки", "систем управління",
                    
                    "asu", "avionics",
                ],
                "common_queries": [
                    "автопілот", "навігація",
                    "управління польотом", "пілотування",
                    "авіаційна електроніка", "датчики",
                ]
            },
            
            "АКІК": {
                "full_name": "Кафедра авіаційних комп'ютерно-інтегрованих комплексів",
                "level": "department",
                "aliases": [
                    "акік", "акик", "акік кафедра",
                    
                    "кафедра авіаційних комп'ютерно-інтегрованих комплексів",
                    "авіаційних комп'ютерно-інтегрованих комплексів",
                    "авіаційні комп'ютерно-інтегровані комплекси",
                    "компютерно-інтегровані комплекси",
                    
                    "кафедра авиационных компьютерно-интегрированных комплексов",
                    "авиационных компьютерно-интегрированных комплексов",
                    "авиационные компьютерно-интегрированные комплексы",
                    
                    "aviation computer-integrated systems",
                    "aircraft computer systems",
                    "avionics computer systems",
                    
                    "комп'ютерно-інтегрованих комплексів",
                    "компьютерно-интегрированных комплексов",
                    "авіаційні комп'ютери",
                    "авиационные компьютеры",
                    "бортові комп'ютери",
                    "бортовые компьютеры",
                    
                    "152", "метрологія та інформаційно-вимірювальна техніка",
                    
                    "акік", "акик", "компютерно-інтегрованих",
                    
                    "akik", "acik",
                ],
                "common_queries": [
                    "бортові системи", "авіаційні комп'ютери",
                    "інтегровані системи", "датчики",
                    "вимірювальна техніка", "метрологія",
                ]
            },
            
            "ЕРМІТ": {
                "full_name": "Кафедра електроніки, робототехніки і технологій моніторингу та інтернету речей",
                "level": "department",
                "aliases": [
                    "ерміт", "єрміт", "ermit",
                    
                    "кафедра електроніки робототехніки",
                    "електроніки робототехніки і технологій моніторингу",
                    "електроніки робототехніки та інтернету речей",
                    "ерміт кафедра",
                    
                    "кафедра электроники робототехники",
                    "электроники робототехники и технологий мониторинга",
                    "электроники робототехники и интернета вещей",
                    
                    "electronics robotics and iot",
                    "electronics and robotics",
                    "iot department",
                    "internet of things",
                    
                    "електроніки",
                    "электроники",
                    "робототехніки",
                    "робототехники",
                    "інтернет речей",
                    "интернет вещей",
                    "iot",
                    "моніторинг",
                    "мониторинг",
                    "роботи",
                    "роботы",
                    
                    "173", "авіоніка",
                    
                    "ерміт", "єрміт", "робототехніки", "інтернету речей",
                    
                    "ermit", "yermit",
                ],
                "common_queries": [
                    "робототехника", "роботи", "arduino",
                    "raspberry pi", "датчики", "sensors",
                    "iot", "умный дом", "розумний дім",
                ]
            },
            
            "АНС": {
                "full_name": "Кафедра аеронавігаційних систем",
                "level": "department",
                "aliases": [
                    "анс", "анс кафедра",
                    
                    "кафедра аеронавігаційних систем",
                    "аеронавігаційних систем",
                    "аеронавігаційні системи",
                    "аеронавігація",
                    
                    "кафедра аэронавигационных систем",
                    "аэронавигационных систем",
                    "аэронавигационные системы",
                    "аэронавигация",
                    
                    "air navigation systems",
                    "aeronavigation systems",
                    "ans department",
                    "navigation systems",
                    
                    "навігаційних систем",
                    "навигационных систем",
                    "навігація",
                    "навигация",
                    "авіаційна навігація",
                    "авиационная навигация",
                    
                    "172", "телекомунікації та радіотехніка",
                    
                    "анс", "аеронавігаційних", "навігація",
                    
                    "ans", "aeronavigation",
                ],
                "common_queries": [
                    "gps", "навігація", "радіонавігація",
                    "супутникова навігація", "карти",
                    "маршрути польотів", "диспетчеризація",
                ]
            },
        }
    },
    
    "global": {
        "full_name": "Національний авіаційний університет",
        "level": "university",
        "aliases": [
            "нау", "nau",
            
            "національний авіаційний університет",
            "національний авіаційний",
            "авіаційний університет",
            
            "национальный авиационный университет",
            "национальный авиационный",
            "авиационный университет",
            
            "national aviation university",
            "aviation university",
            "nau ukraine",
            
            "авіаційний універ",
            "авиационный универ",
            "авіаційка",
            "авиационка",
            "наушка",
            
            "нау", "авіаційний", "авиационный",
            
            "nau", "national aviation",
        ],
        "common_topics": {
            "admission": [
                "вступ", "вступити", "поступить",
                "абітурієнт", "абитуриент",
                "документи", "документы",
                "заява", "заявление",
                "приймальна комісія", "приемная комиссия",
                "конкурс", "бали", "баллы",
                "зно", "нмт", "єві", "зв",
            ],
            "studying": [
                "навчання", "обучение",
                "розклад", "расписание",
                "пари", "пары",
                "сесія", "сессия",
                "іспити", "экзамены",
                "стипендія", "стипендия",
            ],
            "contacts": [
                "контакти", "контакты",
                "телефон", "адреса", "адрес",
                "email", "пошта",
                "як дістатися", "как добраться",
                "де знаходиться", "где находится",
            ],
            "infrastructure": [
                "гуртожиток", "общежитие",
                "бібліотека", "библиотека",
                "їдальня", "столовая",
                "спортзал", "зал",
                "басейн", "бассейн",
            ]
        }
    }
}


# Функції для роботи зі структурою
def find_entity_by_alias(alias: str) -> dict:
    """
    Знаходить факультет або кафедру за будь-яким варіантом написання
    
    Args:
        alias: будь-який варіант назви (наприклад, «фкнт», “іпз”, «комп'ютерних наук»)
    
    Returns:
        dict з інформацією про знайдену сутність або None
    """
    alias_lower = alias.lower().strip()
    
    # Шукаємо у факультетах
    for faculty_code, faculty_data in NAU_STRUCTURE.items():
        if faculty_code == "global":
            continue
            
        # Перевіряємо aliases факультету
        if alias_lower in [a.lower() for a in faculty_data.get("aliases", [])]:
            return {
                "type": "faculty",
                "code": faculty_code,
                "data": faculty_data
            }
        
        # Перевіряємо кафедри
        for dept_code, dept_data in faculty_data.get("departments", {}).items():
            if alias_lower in [a.lower() for a in dept_data.get("aliases", [])]:
                return {
                    "type": "department",
                    "faculty_code": faculty_code,
                    "code": dept_code,
                    "data": dept_data,
                    "faculty_data": faculty_data
                }
    
    return None


def get_all_aliases_for_entity(faculty_code: str, dept_code: str = None) -> list:
    """
    Отримати всі можливі варіанти написання для сутності
    
    Args:
        faculty_code: код факультету (наприклад, «ФКНТ»)
        dept_code: код кафедри (опціонально, наприклад, «ІПЗ»)
    
    Returns:
        list всіх aliases
    """
    if faculty_code not in NAU_STRUCTURE:
        return []
    
    faculty = NAU_STRUCTURE[faculty_code]
    
    if dept_code:
        if dept_code in faculty.get("departments", {}):
            return faculty["departments"][dept_code].get("aliases", [])
        return []
    
    return faculty.get("aliases", [])


def extract_entities_from_text(text: str) -> list:
    """
    Витягує всі згадки факультетів/кафедр з тексту.
    
    Args:
        text: текст для аналізу.
    
    Returns:
        list знайдених сутностей.
    """
    text_lower = text.lower()
    found_entities = []
    
    # Перевіряємо всі можливі aliases
    for faculty_code, faculty_data in NAU_STRUCTURE.items():
        if faculty_code == "global":
            continue
        
        # Перевіряємо faculty aliases
        for alias in faculty_data.get("aliases", []):
            if alias.lower() in text_lower:
                found_entities.append({
                    "type": "faculty",
                    "code": faculty_code,
                    "matched_alias": alias,
                    "full_name": faculty_data["full_name"]
                })
                break  # Знайшли факультет, переходимо до кафедр
        
        # Перевіряємо department aliases
        for dept_code, dept_data in faculty_data.get("departments", {}).items():
            for alias in dept_data.get("aliases", []):
                if alias.lower() in text_lower:
                    found_entities.append({
                        "type": "department",
                        "faculty_code": faculty_code,
                        "code": dept_code,
                        "matched_alias": alias,
                        "full_name": dept_data["full_name"]
                    })
                    break
    
    return found_entities


# Экспорт
__all__ = [
    'NAU_STRUCTURE',
    'find_entity_by_alias',
    'get_all_aliases_for_entity',
    'extract_entities_from_text'
]